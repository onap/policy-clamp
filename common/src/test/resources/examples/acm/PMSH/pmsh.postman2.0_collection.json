{
  "info": {
    "name": "CL-PMSH usecase",
    "_postman_id": "5fb85996-3b5b-40fb-9564-bd44eff287d4",
    "description": "",
    "schema": "https://schema.getpostman.com/json/collection/v2.0.0/collection.json"
  },
  "item": [
    {
      "id": "b436e642-10a0-40d7-a37f-9979693cdb02",
      "name": "Get Instantiated Control loops",
      "request": {
        "url": {
          "protocol": "https",
          "host": "localhost",
          "path": [
            "onap",
            "controlloop",
            "v2",
            "instantiation"
          ],
          "port": "6969"
        },
        "method": "GET",
        "header": [
          {
            "key": "Accept",
            "value": "*/*",
            "disabled": false
          }
        ],
        "body": {
          "mode": "raw",
          "disabled": false
        },
        "description": ""
      },
      "response": [
        {
          "header": [],
          "code": 200,
          "name": "Response_200",
          "id": "d9328b54-71fa-43aa-96cd-0d002e958da9"
        }
      ]
    },
    {
      "id": "021d7ff6-5cad-4967-afe2-f68317cba1f1",
      "name": "Update a Control loop",
      "request": {
        "url": {
          "protocol": "https",
          "host": "localhost",
          "path": [
            "onap",
            "controlloop",
            "v2",
            "instantiation/command"
          ],
          "port": "6969"
        },
        "method": "PUT",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json",
            "description": "",
            "disabled": false
          },
          {
            "key": "X-ONAP-RequestID",
            "value": "709c62b3-8918-41b9-a747-d21eb79c6c20",
            "description": "",
            "disabled": false
          },
          {
            "key": "Accept",
            "value": "*/*",
            "disabled": false
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\r\n  \"orderedState\": \"PASSIVE\",\r\n  \"controlLoopIdentifierList\": [\r\n    {\r\n      \"name\": \"PmshInstance0\",\r\n      \"version\": \"1.0.1\"\r\n    }\r\n  ]\r\n}",
          "disabled": false
        },
        "description": ""
      },
      "response": [
        {
          "header": [],
          "code": 200,
          "name": "Response_200",
          "id": "15718e82-6647-4102-9c1e-7e5c0cc48261"
        }
      ]
    },
    {
      "id": "96d15818-1f95-41bd-ac18-37a96f99a0d8",
      "name": "UnInitialise a Control loop",
      "request": {
        "url": {
          "protocol": "https",
          "host": "localhost",
          "path": [
            "onap",
            "controlloop",
            "v2",
            "instantiation/command"
          ],
          "port": "6969"
        },
        "method": "PUT",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json",
            "description": "",
            "disabled": false
          },
          {
            "key": "Accept",
            "value": "*/*",
            "disabled": false
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\r\n  \"orderedState\": \"UNINTIALISED\",\r\n  \"controlLoopIdentifierList\": [\r\n    {\r\n      \"name\": \"PmshInstance0\",\r\n      \"version\": \"1.0.1\"\r\n    }\r\n  ]\r\n}",
          "disabled": false
        },
        "description": ""
      },
      "response": [
        {
          "header": [],
          "code": 200,
          "name": "Response_200",
          "id": "a02ccea0-d357-4ced-9f19-82bd5712d318"
        }
      ]
    },
    {
      "id": "43776ab0-4851-41bb-8c43-407d0b807696",
      "name": "Instantiate a Control loop",
      "request": {
        "url": {
          "protocol": "https",
          "host": "localhost",
          "path": [
            "onap",
            "controlloop",
            "v2",
            "instantiation"
          ],
          "port": "6969"
        },
        "method": "POST",
        "header": [
          {
            "key": "X-ONAP-RequestID",
            "value": "709c62b3-8918-41b9-a747-d21eb79c6c20",
            "description": "",
            "disabled": false
          },
          {
            "key": "Content-Type",
            "value": "application/json",
            "description": "",
            "disabled": false
          },
          {
            "key": "Accept",
            "value": "*/*",
            "disabled": false
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\r\n  \"controlLoopList\": [\r\n    {\r\n      \"name\": \"PmshInstance0\",\r\n      \"version\": \"1.0.1\",\r\n      \"definition\": {\r\n        \"name\": \"org.onap.domain.sample.GenericK8s_ControlLoopDefinition\",\r\n        \"version\": \"1.2.3\"\r\n      },\r\n      \"state\": \"UNINITIALISED\",\r\n      \"orderedState\": \"UNINITIALISED\",\r\n      \"description\": \"K8s control loop instance 0\",\r\n      \"elements\": {\r\n        \"709c62b3-8918-41b9-a747-d21eb79c6c21\": {\r\n          \"id\": \"709c62b3-8918-41b9-a747-d21eb79c6c21\",\r\n          \"definition\": {\r\n            \"name\": \"org.onap.domain.database.PMSH_K8SMicroserviceControlLoopElement\",\r\n            \"version\": \"1.2.3\"\r\n          },\r\n          \"participantId\": {\r\n            \"name\": \"org.onap.k8s.controlloop.K8SControlLoopParticipant\",\r\n            \"version\": \"2.3.4\"\r\n          },\r\n          \"participantType\": {\r\n            \"name\": \"org.onap.k8s.controlloop.K8SControlLoopParticipant\",\r\n            \"version\": \"2.3.4\"\r\n          },\r\n          \"state\": \"UNINITIALISED\",\r\n          \"orderedState\": \"UNINITIALISED\",\r\n          \"description\": \"K8s Control Loop Element for the PMSH instance 0 control loop\"\r\n        },\r\n        \"709c62b3-8918-41b9-a747-d21eb79c6c22\": {\r\n          \"id\": \"709c62b3-8918-41b9-a747-d21eb79c6c22\",\r\n          \"definition\": {\r\n            \"name\": \"org.onap.domain.database.Local_K8SMicroserviceControlLoopElement\",\r\n            \"version\": \"1.2.3\"\r\n          },\r\n          \"participantId\": {\r\n            \"name\": \"org.onap.k8s.controlloop.K8SControlLoopParticipant\",\r\n            \"version\": \"2.3.4\"\r\n          },\r\n          \"participantType\": {\r\n            \"name\": \"org.onap.k8s.controlloop.K8SControlLoopParticipant\",\r\n            \"version\": \"2.3.4\"\r\n          },\r\n          \"state\": \"UNINITIALISED\",\r\n          \"orderedState\": \"UNINITIALISED\",\r\n          \"description\": \"K8s Control Loop Element for the local instance 0 control loop\"\r\n        },\r\n        \"709c62b3-8918-41b9-a747-d21eb79c6c25\": {\r\n          \"id\": \"709c62b3-8918-41b9-a747-d21eb79c6c25\",\r\n          \"definition\": {\r\n            \"name\": \"org.onap.domain.database.Http_PMSHMicroserviceControlLoopElement\",\r\n            \"version\": \"1.2.3\"\r\n          },\r\n          \"participantId\": {\r\n            \"name\": \"org.onap.controlloop.HttpControlLoopParticipant\",\r\n            \"version\": \"2.3.4\"\r\n          },\r\n          \"participantType\": {\r\n            \"name\": \"org.onap.controlloop.HttpControlLoopParticipant\",\r\n            \"version\": \"2.3.4\"\r\n          },\r\n          \"state\": \"UNINITIALISED\",\r\n          \"orderedState\": \"UNINITIALISED\",\r\n          \"description\": \"DCAE Control Loop Element for the PMSH instance 0 control loop\"\r\n        }\r\n      }\r\n    }\r\n  ]\r\n}",
          "disabled": false
        },
        "description": ""
      },
      "response": [
        {
          "header": [],
          "code": 200,
          "name": "Response_200",
          "id": "855ec245-13ef-48ab-a0e0-3de6e11090a4"
        }
      ]
    },
    {
      "id": "3f6d5d18-8a29-46c3-8fec-d6645e7f7c2b",
      "name": "Commission a Control loop",
      "request": {
        "url": {
          "protocol": "https",
          "host": "localhost",
          "path": [
            "onap",
            "controlloop",
            "v2",
            "commission"
          ],
          "port": "6969"
        },
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/yaml",
            "description": "",
            "disabled": false
          },
          {
            "key": "X-ONAP-RequestID",
            "value": "709c62b3-8918-41b9-a747-d21eb79c6c20",
            "description": "",
            "disabled": false
          },
          {
            "key": "Accept",
            "value": "*/*",
            "disabled": false
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "tosca_definitions_version: tosca_simple_yaml_1_3\ndata_types:\n  onap.datatypes.ToscaConceptIdentifier:\n    derived_from: tosca.datatypes.Root\n    properties:\n      name:\n        type: string\n        required: true\n      version:\n        type: string\n        required: true\n        \n  org.onap.datatypes.policy.clamp.controlloop.httpControlLoopElement.RestRequest:\n    version: 1.0.0\n    derived_from: tosca.datatypes.Root\n    properties:\n      restRequestId:\n        type:  onap.datatypes.ToscaConceptIdentifier\n        typeVersion: 1.0.0\n        required: true\n        description: The name and version of a REST request to be sent to a REST endpoint\n      httpMethod:\n        type: string\n        required: true\n        constraints:\n          - valid_values: [POST, PUT, GET, DELETE]\n        description: The REST method to use\n      path:\n        type: string\n        required: true\n        description: The path of the REST request relative to the base URL\n      body:\n        type: string\n        required: false\n        description: The body of the REST request for PUT and POST requests\n      expectedResponse:\n        type: integer\n        required: true\n        constraints:\n          - in_range: [100, 599]\n        description: THe expected HTTP status code for the REST request\n    org.onap.datatypes.policy.clamp.controlloop.httpControlLoopElement.ConfigurationEntity:\n      version: 1.0.0\n      derived_from: tosca.datatypes.Root\n      properties:\n        configurationEntityId:\n          type:  onap.datatypes.ToscaConceptIdentifier\n          typeVersion: 1.0.0\n          required: true\n          description: The name and version of a Configuration Entity to be handled by the HTTP Control Loop Element\n        restSequence:\n          type: list\n          entry_schema:\n            type: org.onap.datatypes.policy.clamp.controlloop.httpControlLoopElement.RestRequest\n            typeVersion: 1.0.0\n          description: A sequence of REST commands to send to the REST endpoint \nnode_types:\n  org.onap.policy.clamp.controlloop.Participant:\n    version: 1.0.1\n    derived_from: tosca.nodetypes.Root\n    properties:\n      provider:\n        type: string\n        requred: false\n  org.onap.policy.clamp.controlloop.ControlLoopElement:\n    version: 1.0.1\n    derived_from: tosca.nodetypes.Root\n    properties:\n      provider:\n        type: string\n        requred: false\n      participant_id:\n        type: onap.datatypes.ToscaConceptIdentifier\n        requred: true\n  org.onap.policy.clamp.controlloop.ControlLoop:\n    version: 1.0.1\n    derived_from: tosca.nodetypes.Root\n    properties:\n      provider:\n        type: string\n        requred: false\n      elements:\n        type: list\n        required: true\n        entry_schema:\n          type: onap.datatypes.ToscaConceptIdentifier\n  org.onap.policy.clamp.controlloop.K8SMicroserviceControlLoopElement:\n    version: 1.0.1\n    derived_from: org.onap.policy.clamp.controlloop.ControlLoopElement\n    properties:\n      chart:\n        type: string\n        required: true\n      configs:\n        type: list\n        required: false\n      requirements:\n        type: string\n        requred: false\n      templates:\n        type: list\n        required: false\n        entry_schema:\n      values:\n        type: string\n        requred: true\n        \n  org.onap.policy.clamp.controlloop.HttpControlLoopElement:\n    version: 1.0.1\n    derived_from: org.onap.policy.clamp.controlloop.ControlLoopElement\n    properties:\n      baseUrl:\n        type: string\n        required: true\n        description: The base URL to be prepended to each path, identifies the host for the REST endpoints.\n      httpHeaders:\n        type: map\n        required: false\n        entry_schema:\n          type: string\n        description: HTTP headers to send on REST requests\n      configurationEntities:\n        type: map\n        required: true\n        entry_schema:\n          type: org.onap.datatypes.policy.clamp.controlloop.httpControlLoopElement.ConfigurationEntity\n          typeVersion: 1.0.0\n        description: The connfiguration entities the Control Loop Element is managing and their associated REST requests \n       \n   \ntopology_template:\n  node_templates:\n    org.onap.k8s.controlloop.K8SControlLoopParticipant:\n      version: 2.3.4\n      type: org.onap.policy.clamp.controlloop.Participant\n      type_version: 1.0.1\n      description: Participant for K8S\n      properties:\n        provider: ONAP   \n\n    org.onap.domain.database.PMSH_K8SMicroserviceControlLoopElement:  \n      # Chart from new repository    \n      version: 1.2.3\n      type: org.onap.policy.clamp.controlloop.K8SMicroserviceControlLoopElement\n      type_version: 1.0.0\n      description: Control loop element for the K8S microservice for PMSH\n      properties:\n        provider: ONAP\n        participant_id:\n          name: org.onap.k8s.controlloop.K8SControlLoopParticipant\n          version: 2.3.4\n        chart:          \n          chartId: \n            name: dcae-pmsh         \n            version: 8.0.0\n          namespace: onap \n          releaseName: pmshms\n          repository:\n            repoName: chartmuseum\n            protocol: http\n            address: 10.152.183.120\n            port: 80\n            userName: onapinitializer\n            password: demo123456!\n          overrideParams:\n            global.masterPassword: test\n            \n                 \n\n    org.onap.domain.database.Local_K8SMicroserviceControlLoopElement: \n      # Chart installation without passing repository info     \n      version: 1.2.3\n      type: org.onap.policy.clamp.controlloop.K8SMicroserviceControlLoopElement\n      type_version: 1.0.0\n      description: Control loop element for the K8S microservice for local chart\n      properties:\n        provider: ONAP\n        participant_id:\n          name: org.onap.k8s.controlloop.K8SControlLoopParticipant\n          version: 2.3.4\n        chart:\n          chartId:      \n            name: nginx-ingress\n            version: 0.9.1    \n          releaseName: nginxms\n          namespace: test      \n    \n    org.onap.controlloop.HttpControlLoopParticipant:\n      version: 2.3.4\n      type: org.onap.policy.clamp.controlloop.Participant\n      type_version: 1.0.1\n      description: Participant for Http requests\n      properties:\n        provider: ONAP\n\n    org.onap.domain.database.Http_PMSHMicroserviceControlLoopElement:\n      # Consul http config for PMSH.\n      version: 1.2.3\n      type: org.onap.policy.clamp.controlloop.HttpControlLoopElement\n      type_version: 1.0.1\n      description: Control loop element for the http requests of PMSH microservice\n      properties:\n        provider: ONAP\n        participant_id:\n          name: org.onap.controlloop.HttpControlLoopParticipant\n          version: 2.3.4\n        uninitializedToPassiveTimeout: 180\n        baseUrl: http://10.152.183.51:8500\n        httpHeaders:\n          Content-Type: application/json\n        configurationEntities:\n          - configurationEntityId:\n              name: entity1\n              version: 1.0.1\n            restSequence:\n              - restRequestId:\n                  name: request1\n                  version: 1.0.1\n                httpMethod: PUT\n                path: v1/kv/dcae-pmsh2\n                body: '{\n      \"control_loop_name\":\"pmsh-control-loop\",\n      \"operational_policy_name\":\"pmsh-operational-policy\",\n      \"aaf_password\":\"demo123456!\",\n      \"aaf_identity\":\"dcae@dcae.onap.org\",\n      \"cert_path\":\"/opt/app/pmsh/etc/certs/cert.pem\",\n      \"key_path\":\"/opt/app/pmsh/etc/certs/key.pem\",\n      \"ca_cert_path\":\"/opt/app/pmsh/etc/certs/cacert.pem\",\n      \"enable_tls\":\"true\",\n      \"pmsh_policy\":{\n         \"subscription\":{\n            \"subscriptionName\":\"ExtraPM-All-gNB-R2B\",\n            \"administrativeState\":\"UNLOCKED\",\n            \"fileBasedGP\":15,\n            \"fileLocation\":\"\\/pm\\/pm.xml\",\n            \"nfFilter\":{\n               \"nfNames\":[\n                  \"^pnf.*\",\n                  \"^vnf.*\"\n               ],\n               \"modelInvariantIDs\":[\n               ],\n               \"modelVersionIDs\":[\n               ],\n               \"modelNames\":[\n               ]\n            },\n            \"measurementGroups\":[\n               {\n                  \"measurementGroup\":{\n                     \"measurementTypes\":[\n                        {\n                           \"measurementType\":\"countera\"\n                        },\n                        {\n                           \"measurementType\":\"counterb\"\n                        }\n                     ],\n                     \"managedObjectDNsBasic\":[\n                        {\n                           \"DN\":\"dna\"\n                        },\n                        {\n                           \"DN\":\"dnb\"\n                        }\n                     ]\n                  }\n               },\n               {\n                  \"measurementGroup\":{\n                     \"measurementTypes\":[\n                        {\n                           \"measurementType\":\"counterc\"\n                        },\n                        {\n                           \"measurementType\":\"counterd\"\n                        }\n                     ],\n                     \"managedObjectDNsBasic\":[\n                        {\n                           \"DN\":\"dnc\"\n                        },\n                        {\n                           \"DN\":\"dnd\"\n                        }\n                     ]\n                  }\n               }\n            ]\n         }\n      },\n      \"streams_subscribes\":{\n         \"aai_subscriber\":{\n            \"type\":\"message_router\",\n            \"dmaap_info\":{\n               \"topic_url\":\"https://10.152.183.151:3905/events/AAI_EVENT\",\n               \"client_role\":\"org.onap.dcae.aaiSub\",\n               \"location\":\"san-francisco\",\n               \"client_id\":\"1575976809466\"\n            }\n         },\n         \"policy_pm_subscriber\":{\n            \"type\":\"message_router\",\n            \"dmaap_info\":{\n               \"topic_url\":\"https://10.152.183.151:3905/events/org.onap.dmaap.mr.PM_SUBSCRIPTIONS\",\n               \"client_role\":\"org.onap.dcae.pmSubscriber\",\n               \"location\":\"san-francisco\",\n               \"client_id\":\"1575876809456\"\n            }\n         }\n      },\n      \"streams_publishes\":{\n         \"policy_pm_publisher\":{\n            \"type\":\"message_router\",\n            \"dmaap_info\":{\n               \"topic_url\":\"https://10.152.183.151:3905/events/org.onap.dmaap.mr.PM_SUBSCRIPTIONS\",\n               \"client_role\":\"org.onap.dcae.pmPublisher\",\n               \"location\":\"san-francisco\",\n               \"client_id\":\"1475976809466\"\n            }\n         },\n         \"other_publisher\":{\n            \"type\":\"message_router\",\n            \"dmaap_info\":{\n               \"topic_url\":\"https://10.152.183.151:3905/events/org.onap.dmaap.mr.SOME_OTHER_TOPIC\",\n               \"client_role\":\"org.onap.dcae.pmControlPub\",\n               \"location\":\"san-francisco\",\n               \"client_id\":\"1875976809466\"\n            }\n         }\n      }\n   }'\n                expectedResponse: 200\n   \n\n    org.onap.domain.sample.GenericK8s_ControlLoopDefinition:\n      version: 1.2.3\n      type: org.onap.policy.clamp.controlloop.ControlLoop\n      type_version: 1.0.0\n      description: Control loop for Hello World\n      properties:\n        provider: ONAP\n        elements:         \n        - name: org.onap.domain.database.PMSH_K8SMicroserviceControlLoopElement\n          version: 1.2.3     \n        - name: org.onap.domain.database.Local_K8SMicroserviceControlLoopElement\n          version: 1.2.3    \n        - name: org.onap.domain.database.Http_PMSHMicroserviceControlLoopElement\n          version: 1.2.3\n   ",
          "disabled": false
        },
        "description": ""
      },
      "response": [
        {
          "header": [],
          "code": 200,
          "name": "Response_200",
          "id": "d120b824-7fb5-478b-92a3-4d06b92bd00f"
        }
      ]
    }
  ],
  "variable": [],
  "auth": {
    "type": "basic",
    "basic": {
      "username": "runtimeUser",
      "password": "zb!XztG34"
    }
  }
}